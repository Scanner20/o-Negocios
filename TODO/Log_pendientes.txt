Reporte:

Registro de cobranzas : funvta_vtar4210.scx
	30/09/2021:
	Condición: Todos,Por Cobrar. Cobradas , con N/C
	- No se muestra el importe del documento cobrado 
	Tipo documento: N/C 
	- No muestra las N/C del rango de fechas seleccionado

ADMIN
Creación de nuevas Empresas/Compañias 
  Verificar grabación de clave campo CHKCIA  - Listo
  Controlar error campo autoinc en tablas de ventas - Listo (Falta: error handling exception error)
  	- Sugerencias de codigo:
  		************************
	  	FUNCTION UpdateAutoIncID
		LPARAMETERS tcTableName, tcIDfieldName
		LOCAL lnAantalRecords, lnLastID, lnNextID
		USE (tcTableName) IN 0
		SET DELETED OFF 
		* xx = # of records of table    
		SELECT count(*) as xx FROM &tcTableName INTO CURSOR tmp
		lnAantalRecords = xx
		select MAX(&tcIDfieldName) as xx FROM &tcTableName INTO CURSOR tmp
		lnLastID = xx
		lnNextID = MAX(lnAantalRecords,lnLastID) + 1
		USE IN &tcTableName
		ALTER TABLE &tcTableName ALTER COLUMN &tcIDfieldName I NOT NULL AUTOINC NEXTVALUE lnNextID STEP 1
		USE IN &tcTableName	
		************************
		Are you talking about DBFs at all? VFP has no ON DUPLICAT KEY command, MySQL has that.
		In VFP you have SET AUTOINCERROR but what would wortk in any DB is inserting fields except autogenerated.
		INSERT INTO TABLE2 (field2,3,4,5) SELECT field2,3,4,5 FROM Table1
		Yes, it's tedious to need to write out all the field names instead of * but that's how it is, I would like to implement a new DB having * EXCEPT ID as a possibility. But it's too much effort to program a full db just to add one new feature.
		AFAIR Workbench allows to create INSERT and other queriees from a table quite like MSSQL Mangement Studio, so you get your field list from there, not much typing involved.
		Also see https://dev.mysql.com/doc/refman/5.7/en/insert-on-duplicate.html
		It explains how ON DUPLICATE KEY can also be used to do an UPDATE instead of insert and that way merge data with same id. But that actually is off topic and you should ask such things in a MySQL forum, this isn't VFP related as the problem is not with SQLPREPARE or SQLEXEC, it is merely with the table having an autoincrmenting field and with the MySQL statement.
		Bye, Olaf.
		************************
		DEFINE CLASS WordExport AS Custom
		   FUNCTION Export(lcText1,lcText2)
		      LOCAL lReturnValue
		      lReturnValue = .T.
		      TRY
		         * We run the regular code
		         LOCAL oWord as Word.Application
		         oWord = CREATEOBJECT("Word.Application")
		         oWord.Application.Visible = .T.
		         oWord.Documents.Add()
		         oWord.Selection.InsertAfter(lcText1)
		         oWord.Selection.InsertAfter(lcText2)
		      CATCH
		         lReturnValue = .F.

		      FINALLY
		         IF VarType(oWord) = "O"
		            oWord.Application.Quit()
		         ENDIF
		      ENDTRY

		      RETURN lReturnValue
		   ENDFUNC
		ENDDEFINE
		************************

